{# This file is part of SGS-Flask.

   SGS-Flask is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation, either version 3 of the License, or
   (at your option) any later version.
 
   SGS-Flask is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.
 
   You should have received a copy of the GNU General Public License
   along with this program.  If not, see <http://www.gnu.org/licenses/>.
 
   Copyright Swallowtail Garden Seeds, Inc 
#}

{% extends "includes/base.html" %}
{% from "includes/form_field.html" import form_field %}
{% block head %}
<title>Checkout</title>
{% endblock %}
{% block main %}
<h1>Checkout</h1>
<form method="POST">
  {{ form.hidden_tag() }}
  <ol>
    <fieldset>
      <legend>Billing Address:</legend>
      <li>{{ form_field(form.billing_address.first_name)|safe }}</li>
      <li>{{ form_field(form.billing_address.last_name)|safe }}</li>
      <li>{{ form_field(form.billing_address.business_name)|safe }}</li>
      <li>{{ form_field(form.billing_address.address_line1)|safe }}</li>
      <li>{{ form_field(form.billing_address.address_line2)|safe }}</li>
      <li>{{ form_field(form.billing_address.city)|safe }}</li>
      <li>{{ form_field(form.billing_address.country, onchange='showStateSelect(this)')|safe }}</li>
      <li><span id="billing_address-usa-state-select">{{ form_field(form.billing_address.usa_state)|safe }}</span><span id="billing_address-can-state-select">{{form_field(form.billing_address.can_state)|safe}}</span><span id="billing_address-aus-state-select">{{form_field(form.billing_address.aus_state)|safe }}</span><span id="billing_address-other-state">{{ form_field(form.billing_address.unlisted_state)|safe }}</span></li>
      <li>{{ form_field(form.billing_address.email)|safe }}</li>
      <li>{{ form_field(form.billing_address.phone)|safe }}</li>
      <li>{{ form_field(form.billing_address.fax)|safe }}</li>
    </fieldset>
    <fieldset>
      <legend>Shipping Address:</legend>
      <li>{{ form_field(form.shipping_address.first_name)|safe }}</li>
      <li>{{ form_field(form.shipping_address.last_name)|safe }}</li>
      <li>{{ form_field(form.shipping_address.business_name)|safe }}</li>
      <li>{{ form_field(form.shipping_address.address_line1)|safe }}</li>
      <li>{{ form_field(form.shipping_address.address_line2)|safe }}</li>
      <li>{{ form_field(form.shipping_address.city)|safe }}</li>
      <li>{{ form_field(form.shipping_address.country, onchange='showStateSelect(this)')|safe }}</li>
      <li><span id="shipping_address-usa-state-select">{{ form_field(form.shipping_address.usa_state)|safe }}</span><span id="shipping_address-can-state-select">{{form_field(form.shipping_address.can_state)|safe}}</span><span id="shipping_address-aus-state-select">{{form_field(form.shipping_address.aus_state)|safe }}</span><span id="shipping_address-other-state">{{ form_field(form.shipping_address.unlisted_state)|safe }}</span></li>
      <li>{{ form_field(form.shipping_address.email)|safe }}</li>
      <li>{{ form_field(form.shipping_address.phone)|safe }}</li>
      <li>{{ form_field(form.shipping_address.fax)|safe }}</li>
    </fieldset>
    {{ form_field(form.submit)|safe }}
  </ol>
</form>
{% endblock %}
{% block scripts %}
<script>
  function showStateSelect(country){
    var prefix = country.id.split("-")[0];
    if(country.value == 'USA') {
      document.getElementById(prefix.concat('-other-state')).style.display = "none";
      document.getElementById(prefix.concat('-can-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-aus-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-usa-state-select')).style.display = "inline";
    } else if (country.value == 'CAN') {
      document.getElementById(prefix.concat('-other-state')).style.display = "none";
      document.getElementById(prefix.concat('-usa-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-aus-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-can-state-select')).style.display = "inline";
    } else if (country.value == 'AUS') {
      document.getElementById(prefix.concat('-other-state')).style.display = "none";
      document.getElementById(prefix.concat('-usa-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-can-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-aus-state-select')).style.display = "inline";
    } else {
      document.getElementById(prefix.concat('-usa-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-can-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-aus-state-select')).style.display = "none";
      document.getElementById(prefix.concat('-other-state')).style.display = "inline";
    }
  };
  showStateSelect(document.getElementById('billing_address-country'));
  showStateSelect(document.getElementById('shipping_address-country'));
</script>
{% endblock %}
